<%- include('../layouts/main') %>
    <div class="container-fluid">
      <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
          <h1 class="page-title">
            <i class="fas fa-edit me-3 fa-bounce"></i>Chỉnh sửa sản phẩm
          </h1>
          <p class="text-muted">
            <i class="fas fa-info-circle me-2"></i>Cập nhật thông tin sản phẩm: <strong><%= product.name %></strong>
          </p>
        </div>
        <a href="/products" class="btn btn-secondary">
          <i class="fas fa-arrow-left me-2"></i>Quay lại
        </a>
      </div>

      <div class="row justify-content-center">
        <div class="col-lg-8">
          <div class="admin-card">
            <div class="card-header">
              <h5><i class="fas fa-box me-2"></i>Thông tin sản phẩm</h5>
            </div>
            <div class="card-body">
              <form action="/products/<%= product._id %>?_method=PUT" method="POST">
                <div class="row">
                  <div class="col-md-6 mb-3">
                    <label for="name" class="form-label">
                      <i class="fas fa-tag me-2"></i>Tên sản phẩm <span class="text-danger">*</span>
                    </label>
                    <input type="text" class="form-control form-control-admin" id="name" name="name" 
                           value="<%= typeof formData !== 'undefined' ? formData.name : product.name %>" required>
                    <% if (typeof errors !== 'undefined' && errors.find(e => e.path === 'name')) { %>
                      <div class="text-danger mt-1">
                        <i class="fas fa-exclamation-circle me-1"></i>
                        <%= errors.find(e => e.path === 'name').msg %>
                      </div>
                    <% } %>
                  </div>
                  
                  <div class="col-md-6 mb-3">
                    <label for="price" class="form-label">
                      <i class="fas fa-dollar-sign me-2"></i>Giá <span class="text-danger">*</span>
                    </label>
                    <input type="number" step="0.01" min="0" class="form-control form-control-admin" id="price" name="price" 
                           value="<%= typeof formData !== 'undefined' ? formData.price : product.price %>" required>
                    <% if (typeof errors !== 'undefined' && errors.find(e => e.path === 'price')) { %>
                      <div class="text-danger mt-1">
                        <i class="fas fa-exclamation-circle me-1"></i>
                        <%= errors.find(e => e.path === 'price').msg %>
                      </div>
                    <% } %>
                  </div>
                </div>

                <div class="row">
                  <div class="col-md-6 mb-3">
                    <label for="brand" class="form-label">
                      <i class="fas fa-building me-2"></i>Thương hiệu
                    </label>
                    <input type="text" class="form-control form-control-admin" id="brand" name="brand" 
                           value="<%= typeof formData !== 'undefined' ? formData.brand : (product.brand || '') %>">
                    <% if (typeof errors !== 'undefined' && errors.find(e => e.path === 'brand')) { %>
                      <div class="text-danger mt-1">
                        <i class="fas fa-exclamation-circle me-1"></i>
                        <%= errors.find(e => e.path === 'brand').msg %>
                      </div>
                    <% } %>
                  </div>
                  
                  <div class="col-md-6 mb-3">
                    <label for="category" class="form-label">
                      <i class="fas fa-layer-group me-2"></i>Danh mục
                    </label>
                    <select class="form-control form-control-admin" id="category" name="category">
                      <option value="General" <%= ((typeof formData !== 'undefined' ? formData.category : product.category) === 'General') ? 'selected' : '' %>>General</option>
                      <option value="Electronics" <%= ((typeof formData !== 'undefined' ? formData.category : product.category) === 'Electronics') ? 'selected' : '' %>>Electronics</option>
                      <option value="Clothing" <%= ((typeof formData !== 'undefined' ? formData.category : product.category) === 'Clothing') ? 'selected' : '' %>>Clothing</option>
                      <option value="Books" <%= ((typeof formData !== 'undefined' ? formData.category : product.category) === 'Books') ? 'selected' : '' %>>Books</option>
                      <option value="Home" <%= ((typeof formData !== 'undefined' ? formData.category : product.category) === 'Home') ? 'selected' : '' %>>Home</option>
                      <option value="Sports" <%= ((typeof formData !== 'undefined' ? formData.category : product.category) === 'Sports') ? 'selected' : '' %>>Sports</option>
                    </select>
                    <% if (typeof errors !== 'undefined' && errors.find(e => e.path === 'category')) { %>
                      <div class="text-danger mt-1">
                        <i class="fas fa-exclamation-circle me-1"></i>
                        <%= errors.find(e => e.path === 'category').msg %>
                      </div>
                    <% } %>
                  </div>
                </div>

                <div class="row">
                  <div class="col-md-6 mb-3">
                    <label for="stock" class="form-label">
                      <i class="fas fa-boxes me-2"></i>Số lượng tồn kho
                    </label>
                    <input type="number" min="0" class="form-control form-control-admin" id="stock" name="stock" 
                           value="<%= typeof formData !== 'undefined' ? formData.stock : (product.stock || 0) %>">
                    <% if (typeof errors !== 'undefined' && errors.find(e => e.path === 'stock')) { %>
                      <div class="text-danger mt-1">
                        <i class="fas fa-exclamation-circle me-1"></i>
                        <%= errors.find(e => e.path === 'stock').msg %>
                      </div>
                    <% } %>
                  </div>
                  
                  <div class="col-md-6 mb-3">
                    <label for="imageUrl" class="form-label">
                      <i class="fas fa-image me-2"></i>URL hình ảnh
                    </label>
                    <input type="url" class="form-control form-control-admin" id="imageUrl" name="imageUrl" 
                           value="<%= typeof formData !== 'undefined' ? formData.imageUrl : (product.imageUrl || '') %>" 
                           placeholder="https://example.com/image.jpg">
                    <% if (typeof errors !== 'undefined' && errors.find(e => e.path === 'imageUrl')) { %>
                      <div class="text-danger mt-1">
                        <i class="fas fa-exclamation-circle me-1"></i>
                        <%= errors.find(e => e.path === 'imageUrl').msg %>
                      </div>
                    <% } %>
                  </div>
                </div>

                <div class="mb-3">
                  <label for="description" class="form-label">
                    <i class="fas fa-align-left me-2"></i>Mô tả sản phẩm
                  </label>
                  <textarea class="form-control form-control-admin" id="description" name="description" rows="4" 
                            placeholder="Mô tả chi tiết về sản phẩm..."><%= typeof formData !== 'undefined' ? formData.description : (product.description || '') %></textarea>
                  <% if (typeof errors !== 'undefined' && errors.find(e => e.path === 'description')) { %>
                    <div class="text-danger mt-1">
                      <i class="fas fa-exclamation-circle me-1"></i>
                      <%= errors.find(e => e.path === 'description').msg %>
                    </div>
                  <% } %>
                </div>

                <div class="mb-3">
                  <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="isActive" name="isActive" 
                           <%= (typeof formData !== 'undefined' ? formData.isActive : product.isActive) ? 'checked' : '' %>>
                    <label class="form-check-label" for="isActive">
                      <i class="fas fa-toggle-on me-2"></i>Sản phẩm hoạt động
                    </label>
                  </div>
                </div>

                <div class="d-flex gap-3">
                  <button type="submit" class="btn btn-admin-primary">
                    <i class="fas fa-save me-2"></i>Cập nhật sản phẩm
                  </button>
                  <a href="/products" class="btn btn-secondary">
                    <i class="fas fa-times me-2"></i>Hủy
                  </a>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
