<div class="grid grid-cols-1 md:grid-cols-2 gap-6">
  <div>
    <img class="w-full h-72 object-cover rounded" src="<%= product.imageUrl || 'https://via.placeholder.com/800x600' %>" alt="<%= product.name %>" />
  </div>
  <div>
    <h1 class="text-3xl font-bold"><%= product.name %></h1>
    <div class="text-gray-600"><%= product.brand %></div>
    <div class="mt-3"><%= product.description %></div>
    <div class="text-pink-600 font-bold text-xl mt-2">$<%= product.price.toFixed(2) %></div>

    <% if (member && (member.role === 'member' || member.role === 'admin')) { %>
      <form class="mt-6 space-y-2" action="/products/<%= product._id %>/feedback" method="post">
        <div>
          <label class="block text-sm font-medium">Your feedback</label>
          <textarea name="content" class="w-full border rounded p-2" required></textarea>
        </div>
        <div>
          <label class="block text-sm font-medium">Rating (1-5)</label>
          <input class="border rounded p-2" type="number" name="rating" min="1" max="5" value="5" required />
        </div>
        <button class="px-4 py-2 bg-blue-600 text-white rounded" type="submit">Submit</button>
        <p class="text-xs text-gray-500">Note: Only one active feedback at a time per member. Submitting a new one deactivates previous.</p>
      </form>
    <% } %>
  </div>
</div>

<div class="mt-8">
  <h2 class="text-xl font-semibold mb-2">Feedback</h2>
  <div class="space-y-3">
    <% feedbacks.forEach(f => { %>
      <div class="border rounded p-3">
        <div class="font-semibold"><%= f.member?.username || 'Member' %> - ‚≠ê <%= f.rating %></div>
        <div><%= f.content %></div>
      </div>
    <% }) %>
    <% if (feedbacks.length === 0) { %>
      <div>No feedback yet.</div>
    <% } %>
  </div>
</div>


